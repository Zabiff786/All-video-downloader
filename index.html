<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All-In-One Video Downloader</title>
    <!-- Google Fonts for a modern look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS is pre-configured for a great look */
        :root {
            --primary-color: #007bff; /* A nice, neutral blue */
            --secondary-color: #343a40; /* Darker Gray */
            --accent-color: #5f27cd;
            --accent-color-hover: #341f97;
            --bg-color: #f4f7f6;
            --card-bg-color: #ffffff;
            --text-color: #333;
            --light-text-color: #777;
            --border-radius: 12px;
            --box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            margin: 0; padding: 2rem 1rem;
            display: flex; justify-content: center; align-items: flex-start;
            min-height: 100vh;
        }
        .downloader-container {
            width: 100%; max-width: 700px;
            background: var(--card-bg-color);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 2.5rem; text-align: center;
        }
        .downloader-header h1 { margin: 0 0 0.5rem 0; font-size: 2.25rem; font-weight: 700; color: var(--primary-color); }
        .downloader-header p { margin: 0 0 2rem 0; font-size: 1.1rem; color: var(--light-text-color); }
        #download-form { display: flex; gap: 1rem; }
        #video-url-input { flex-grow: 1; padding: 0 1rem; font-size: 1rem; border: 2px solid #ddd; border-radius: var(--border-radius); transition: all 0.3s ease; }
        #video-url-input:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25); }
        #download-button { display: flex; align-items: center; justify-content: center; padding: 0.8rem 1.5rem; font-size: 1rem; font-weight: 600; color: #fff; background-image: linear-gradient(to right, var(--accent-color) 0%, var(--accent-color-hover) 100%); border: none; border-radius: var(--border-radius); cursor: pointer; transition: all 0.3s ease; min-width: 150px; }
        #download-button:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(95, 39, 205, 0.4); }
        #download-button:disabled { opacity: 0.7; cursor: not-allowed; transform: translateY(0); box-shadow: none; }
        .loader { width: 20px; height: 20px; border: 3px solid rgba(255, 255, 255, 0.5); border-top-color: #fff; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        #message-area { margin-top: 1.5rem; text-align: left; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .message { padding: 1rem; border-radius: var(--border-radius); margin-bottom: 1rem; border: 1px solid transparent; }
        .message.error { background-color: #f8d7da; color: #721c24; border-color: #f5c6cb; }
        #video-info { display: flex; flex-wrap: wrap; gap: 1.5rem; padding: 1.5rem; background: #f8f9fa; border-radius: var(--border-radius); border: 1px solid #e9ecef; }
        #video-thumbnail { width: 160px; height: 90px; object-fit: cover; border-radius: 8px; flex-shrink: 0; }
        #video-details { flex: 1; min-width: 200px; text-align: left; }
        #video-details h3 { margin: 0 0 0.5rem 0; font-size: 1.2rem; }
        #download-options h4 { margin-top: 1.5rem; margin-bottom: 1rem; font-size: 1.1rem; color: var(--primary-color); text-align: left;}
        #download-links { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.75rem; }
        .download-link { display: block; padding: 0.75rem; background-color: var(--secondary-color); color: #fff; text-align: center; text-decoration: none; border-radius: 8px; font-weight: 500; transition: background-color 0.3s ease, transform 0.2s ease; }
        .download-link:hover { background-color: var(--primary-color); transform: scale(1.05); }
        @media (max-width: 600px) { .downloader-container { padding: 1.5rem; } #download-form { flex-direction: column; } #video-url-input { height: 50px; } #video-info { flex-direction: column; align-items: center; text-align: center; } #video-details { text-align: center; } }
    </style>
</head>
<body>

    <div class="downloader-container">
        <header class="downloader-header">
            <h1>All-In-One Video Downloader</h1>
            <p>Paste a link from TikTok, Instagram, YouTube, etc.</p>
        </header>
        <main>
            <form id="download-form">
                <input type="text" id="video-url-input" placeholder="https://www.tiktok.com/..." required>
                <button type="submit" id="download-button">
                    <span id="button-text">Get Links</span>
                    <div class="loader" id="loader" style="display: none;"></div>
                </button>
            </form>
            <div id="message-area"></div>
        </main>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        // --- API Configuration ---
        // Your API key is inserted. The tool is ready.
        const apiKey = '6f515ae38cmsh8e5cd660ce092f7p198078jsn2a66704fc510';
        const apiHost = 'social-download-all-in-one.p.rapidapi.com';
        const apiUrl = 'https://social-download-all-in-one.p.rapidapi.com/v1/social/autolink';

        // --- DOM Element References ---
        const downloadForm = document.getElementById('download-form');
        const urlInput = document.getElementById('video-url-input');
        const downloadButton = document.getElementById('download-button');
        const buttonText = document.getElementById('button-text');
        const loader = document.getElementById('loader');
        const messageArea = document.getElementById('message-area');

        /**
         * Main form submission handler
         */
        downloadForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const videoUrl = urlInput.value.trim();

            if (!isValidUrl(videoUrl)) {
                displayMessage('Please enter a valid video URL.', 'error');
                return;
            }

            setLoading(true);
            messageArea.innerHTML = '';

            try {
                const data = await fetchFromApi(videoUrl);
                displayResults(data);
            } catch (error) {
                displayMessage(error.message, 'error');
            } finally {
                setLoading(false);
            }
        });

        /**
         * Fetches video info from the 'social-download-all-in-one' API.
         * @param {string} videoUrl - The full URL of the video from any platform.
         */
        async function fetchFromApi(videoUrl) {
            const options = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-RapidAPI-Key': apiKey,
                    'X-RapidAPI-Host': apiHost
                },
                body: JSON.stringify({ url: videoUrl })
            };

            const response = await fetch(apiUrl, options);
            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.message || 'API request failed. Check the URL or your API plan.');
            }
            return await response.json();
        }
        
        /**
         * Displays the results based on the API response.
         * @param {object} apiResponse - The full response from the API.
         */
        function displayResults(apiResponse) {
            const data = apiResponse.body; // The actual content is nested in the 'body' property

            if (!data || !data.medias || data.medias.length === 0) {
                displayMessage('Could not find any downloadable formats for this URL.', 'error');
                return;
            }

            const videos = data.medias.filter(m => m.type === 'video');
            const audios = data.medias.filter(m => m.type === 'audio');
            const thumbnail = data.thumbnail;
            const title = data.title;

            let resultsHtml = '';

            // Add thumbnail and title if available
            if (thumbnail || title) {
                resultsHtml += `
                    <div id="video-info">
                        ${thumbnail ? `<img id="video-thumbnail" src="${thumbnail}" alt="Thumbnail">` : ''}
                        ${title ? `<div id="video-details"><h3>${title}</h3></div>` : ''}
                    </div>`;
            }

            // Generate links for video formats
            if (videos.length > 0) {
                resultsHtml += '<div id="download-options"><h4>Video</h4><div id="download-links">';
                resultsHtml += videos.map(format => `
                    <a href="${format.url}" class="download-link" target="_blank">
                        ${format.quality} <small>(${format.extension})</small>
                    </a>
                `).join('');
                resultsHtml += '</div></div>';
            }

            // Generate links for audio formats
            if (audios.length > 0) {
                resultsHtml += '<div id="download-options"><h4>Audio</h4><div id="download-links">';
                resultsHtml += audios.map(format => `
                    <a href="${format.url}" class="download-link" target="_blank">
                        ${format.quality} <small>(${format.extension})</small>
                    </a>
                `).join('');
                resultsHtml += '</div></div>';
            }

            messageArea.innerHTML = resultsHtml;
        }

        // --- Helper Functions ---
        function setLoading(isLoading) {
            downloadButton.disabled = isLoading;
            loader.style.display = isLoading ? 'block' : 'none';
            buttonText.style.display = isLoading ? 'none' : 'block';
        }

        function displayMessage(text, type) {
            messageArea.innerHTML = `<div class="message ${type}">${text}</div>`;
        }
        
        function isValidUrl(urlString) {
            try {
                new URL(urlString);
                return true;
            } catch (_) {
                return false;
            }
        }
    });
    </script>
</body>
</html>
